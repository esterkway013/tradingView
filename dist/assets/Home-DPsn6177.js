import{_ as w,r as _,o as k,c as C,a as y,b as T,t as b,d as D,e as L}from"./index-DWB5FjiO.js";function P({startPrice:u=100,maxPoints:i=30,minDelta:l=3,maxDelta:e=10,interval:d=1e3}={}){const r=[];let o=null;function n(){return{time:Date.now(),price:Math.floor(Math.random()*-19)+120}}function c(f){r.push(f),r.length>i&&r.shift()}function t(){const f=n();return c(f),f}function s(f){if(o)return;r.length=0;const h={time:Date.now(),price:u};r.push(h),f(h),o=setInterval(()=>{const p=t();f(p)},d)}function a(){clearInterval(o),o=null}function m(){return console.log(r,"data in realtimeSeries"),r}return{start:s,stop:a,getData:m}}function S({width:u,height:i,padding:l}){let e=0,d=1;function r(t,s){e=t,d=s===t?t+1:s}function o(){return console.log("123",e,d),{min:e,max:d}}function n(t,s){if(s<=1)return l;const a=u-l*2;return l+t/(s-1)*a}function c(t){const s=d-e||1,a=i-l*2;return l+(t-e)/s*a}return{width:u,height:i,padding:l,setDomain:r,getDomain:o,mapX:n,mapY:c}}function I({scale:u}){console.log(u,"scale in axisLayer");const i=5;function l(e){const{width:d,height:r,padding:o}=u,n=Math.round(d-o)+.5;e.save(),e.strokeStyle="#334155",e.lineWidth=1,e.beginPath(),e.moveTo(n,o),e.lineTo(n,r-o),e.stroke(),e.beginPath(),e.moveTo(o,r-o),e.lineTo(n,r-o),e.stroke();const{min:c,max:t}=u.getDomain(),s=t-c||1;e.fillStyle="#64748b",e.font="12px sans-serif",e.textAlign="left",e.textBaseline="middle";for(let a=i;a>=0;a--){const m=c+s/i*a,f=u.mapY(m);e.beginPath(),e.moveTo(n,f),e.lineTo(n+4,f),e.stroke(),e.fillText(m.toFixed(2),n+6,f)}e.restore()}return{draw:l}}function M({data:u,scale:i}){let l=null,e=!0;function d(){const n=u.value.length;if(n<2){l=null,e=!1;return}console.log("lineLayer rebuild");const c=new Path2D;for(let t=0;t<n;t++){const s=u.value[t],a=i.mapX(t,n),m=i.mapY(s.price);t===0?c.moveTo(a,m):c.lineTo(a,m)}l=c,e=!1}function r(n){e&&d(),l&&(n.save(),n.strokeStyle="#38BDF8",n.lineWidth=2,n.lineCap="round",n.lineJoin="round",n.stroke(l),n.restore())}function o(){e=!0}return{draw:r,markDirty:o}}const x={class:"chart"},v=800,g=700,B={__name:"ChartCanvas",props:{data:Array},setup(u){const i=window.devicePixelRatio||1,l=_(null),e=_(null),d=_(null);let r=null,o=null,n=null,c=null,t=null,s=null;const a=_([]);k(()=>{r=P({startPrice:100,maxPoints:30,interval:1e3}),a.value=r.getData(),o=m(e.value),t=m(l.value),n=S({width:v,height:g,padding:40}),c=M({data:a,scale:n}),s=I({scale:n}),r.start(()=>{console.log(a.value,"data");const h=a.value.length>0?a.value.map(p=>p.price):[];n.setDomain(Math.min(...h),Math.max(...h)),c.markDirty(),f()})});function m(h){h.width=v*i,h.height=g*i,h.style.width=`${v}px`,h.style.height=`${g}px`;const p=h.getContext("2d");return p.scale(i,i),p}function f(){o.clearRect(0,0,v,g),t.clearRect(0,0,v,g),c.draw(o),s.draw(t),console.log(a.value,"data")}return(h,p)=>(D(),C("div",x,[y("canvas",{id:"axisCanvas",ref_key:"axisCanvas",ref:l},null,512),y("canvas",{id:"lineCanvas",ref_key:"lineCanvas",ref:e},null,512),y("canvas",{ref_key:"interactionCanvas",ref:d},null,512),T(" "+b(a.value),1)]))}},H=w(B,[["__scopeId","data-v-c255c9d2"]]),R={__name:"Home",setup(u){return(i,l)=>(D(),C("div",null,[L(H)]))}};export{R as default};
